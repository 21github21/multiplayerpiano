// Generated by CoffeeScript 1.6.1
(function() {
  var MIDI_CHANNEL, MIDI_VOLUME, attachListeners, init, socket;

  socket = io.connect();

  MIDI_CHANNEL = 0;

  MIDI_VOLUME = 127;

  $(document).ready(function() {
    init();
    return attachListeners();
  });

  init = function() {
    return MIDI.loadPlugin({
      soundfontUrl: "/static/soundfonts/",
      instrument: "acoustic_grand_piano",
      callback: function() {
        return MIDI.setVolume(MIDI_CHANNEL, MIDI_VOLUME);
      }
    });
  };

  attachListeners = function() {
    $('span').each(function(i, el) {
      $(el).mousedown(function() {
        var note;
        note = $(el).data('note');
        MIDI.noteOn(MIDI_CHANNEL, note, MIDI_VOLUME, 0);
        return socket.emit('note_on', note);
      });
      return $(el).mouseup(function() {
        var note;
        note = $(el).data('note');
        MIDI.noteOff(MIDI_CHANNEL, note);
        return socket.emit('note_off', note);
      });
    });
    socket.on('note_on', function(note) {
      return MIDI.noteOn(MIDI_CHANNEL, note, MIDI_VOLUME, 0);
    });
    return socket.on('note_off', function(note) {
      return MIDI.noteOff(MIDI_CHANNEL, note);
    });
  };

}).call(this);
